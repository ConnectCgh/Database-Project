SpeedEats 答辩文案
==================

开场介绍
--------

- **产品定位**：SpeedEats 是面向顾客、商家、骑手、平台四类角色的多端外卖系统，核心流程覆盖“入驻/签约 → 上线餐品与折扣 → 下单 → 骑手履约 → 评分监管”。
- **技术栈**：后端基于 Django 5.2，九个 app 统一注册到 `Project/settings.py` 并集中在 `Project/urls.py` 挂载路由；前端采用 Django 模板 + 原生 HTML/CSS/JS，所有页面用 `fetch + JsonResponse` 完成交互。
- **部署方式**：默认直连远程 MySQL（`HOST=124.70.86.207`），支持 `manage.py` 本地调试；为了多 app 共享查询，封装了 `Project/db_utils.py` 执行原生 SQL，结合 Django ORM 提供高自由度和性能控制。

系统架构
--------

- **模块划分**：登录/注册、顾客、商家、骑手、平台、共享模型等九个 app，后端逻辑集中在 `views.py`，模板位于各 app 的 `templates/` 目录，清晰体现“职责内聚”的 MVC 结构。
- **统一身份体系**：`login/models.py` 中 `UserProfile` 一对一扩展 `auth.User`，再对应到顾客/商家/骑手/平台四张角色表，并通过 `post_save` 信号自动建档，保证四端共享一个账号体系。
- **数据访问层**：`Project/db_utils.py` 封装 `execute_fetchall/execute_write` 等方法，既复用连接池也能书写复杂 SQL（聚合、批量更新），方便跨模块操作订单或审批数据。

数据库设计（ER 重点）
------------------

- **用户域**：`user_profile`（账号 + 角色类型 + 手机）拆分成 `customer/merchant/platform/rider` 四张角色表，补充地址、状态、评分等业务字段，满足多角色共账号而又可拓展字段的诉求。
- **交易域**：`order` 记录顾客、平台、商家、餐品、折扣、骑手以及 `unassigned/assigned/ready/completed/cancelled` 状态机；`order_rating` 按订单一对一存放四类评分，实现交易闭环。
- **治理域**：`enter_request`（商家入驻申请）、`sign_request`（骑手签约）、`merchant_platform_discount`（平台折扣绑定），配合 unique 约束避免重复申请，支撑“多商家、多平台、多折扣”的多对多关系。

核心业务逻辑
------------

### 登录 / 注册

- 登录视图先认证用户，再根据 `UserProfile.user_type` 跳转至对应角色主页；注册流程在写入 `auth_user` 后等待信号自动生成 `UserProfile`，若失败再兜底补齐，并创建对应角色实体同时自动登录。

### 顾客端

- `customer()` 视图一次性聚合平台、商家、餐品、折扣与当前用户订单，生成仪表盘式上下文；`place_order()` 校验商家是否入驻平台、折扣是否有效，按餐品逐条写入 `order` 并计算折扣价。
- 其余接口负责订单列表、商家搜索、订单删除/取餐、评分等，评分逻辑通过 `_normalize_rating` 和 `_update_entity_rating` 更新商家/餐品/平台/骑手的平均分。

### 商家端

- `apply_platform()`、`add_meal()`、`edit_meal()`、`set_discount()` 等接口构成“申请入驻 + 餐品/折扣 CRUD”的闭环，所有操作都检查商家是否已被平台批准，确保权限和数据一致性。
- `get_orders()` 等接口让商家监控订单并删除未分配骑手的订单，避免异常单据堆积。

### 骑手端

- 骑手先通过 `apply_platform()` 向平台发起签约申请；`accept_orders()`/`cancel_orders()`/`complete_orders()` 基于骑手签约的平台集合批量更新订单，实现“同一商家+顾客组合的订单一次性接/退/完”。

### 平台端

- 平台视图 `platform()` 收集商家入驻、骑手签约、订单统计，并提供审批/拒绝/移除接口，体现平台监管角色；`delete_order()` 能清理未分配骑手的订单，维持系统整洁。

前端交互与界面
--------------

- **顾客页面**：暗色仪表盘 UI，卡片展示平台和商家，订单表格支持状态按钮、评分模态；底部 JS 管理导航切换、CSRF token、modal 打开、`fetch` 下单/评分/搜索/删除等逻辑，呈现类 SPA 体验。
- **商家页面**：侧边栏 + 多卡片布局，含餐品/折扣/订单管理，JS 负责导航、订单筛选、删除确认以及 AJAX 调用。
- **骑手 & 平台页面**：骑手界面以“商家 + 顾客”组合卡片显示待接/已接订单；平台界面提供审批按钮、订单统计卡片，支撑演示期间快速切换角色查看全链路状态。

项目亮点
--------

1. **统一账号自动建档**：用户注册即触发信号创建 `UserProfile` 与四类角色记录，避免手工维护账号关联。
2. **平台治理闭环**：入驻、签约、移除全流程可在平台端审批，确保商家/骑手管理受控且可溯。
3. **批量订单处理**：骑手端支持按商家+顾客组合批量接单/退单/完单，减少重复操作。
4. **多维评分体系**：订单完成后顾客可对商家/餐品/平台/骑手分别评分，后端实时刷新平均分，驱动前端排序与展示。
5. **原生 SQL + 模板工程实践**：自建 `db_utils` 结合模板内 JS，让我们在无前端框架的前提下实现复杂交互与高性能查询。

答辩演示路线
------------

1. **架构 & 数据库**：展示多 app 架构图 + ER 图，重点讲统一身份与多对多关系。
2. **角色流程 Demo**：顺序演示“注册 → 商家申请 → 平台审核 → 商家上架 → 顾客下单 → 骑手接单/完成 → 平台监管与评分”，让老师看到完整闭环。
3. **技术亮点总结**：强调信号驱动建档、审批闭环、批量订单与评分体系，补充原生 SQL + 模板前端的工程思考，结尾呼应项目价值。
